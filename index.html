<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Price Tracker Wishlist</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      transition: background-color 0.3s, color 0.3s;
    }
    .dark-mode {
      background-color: #1a202c;
      color: #e2e8f0;
    }
    .dark-mode .bg-gray-100 {
      background-color: #2d3748;
    }
    .dark-mode .bg-white {
      background-color: #4a5568;
      color: #e2e8f0;
    }
    .dark-mode .text-gray-800 {
      color: #e2e8f0;
    }
    .dark-mode .text-gray-700 {
      color: #cbd5e0;
    }
    .dark-mode .text-gray-600 {
      color: #a0aec0;
    }
    .dark-mode .text-gray-500 {
      color: #718096;
    }
    .dark-mode .border-gray-300 {
      border-color: #4a5568;
    }
    .dark-mode .focus\:ring-blue-500:focus {
      --tw-ring-color: #63b3ed;
    }
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    .animate-fade-in {
      animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
  <nav class="bg-white shadow-lg dark-mode:bg-gray-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex items-center">
          <h1 class="text-xl font-bold text-gray-800 dark-mode:text-white"><i class="fas fa-tags mr-2"></i>Price Tracker Wishlist</h1>
        </div>
        <div class="flex items-center space-x-4">
          <button id="darkModeToggle" class="text-gray-600 hover:text-gray-800 dark-mode:text-gray-300 dark-mode:hover:text-white transition">
            <i class="fas fa-moon"></i>
          </button>
          <button class="text-gray-600 hover:text-gray-800 dark-mode:text-gray-300 dark-mode:hover:text-white transition">
            <i class="fas fa-cog"></i>
          </button>
        </div>
      </div>
    </div>
  </nav>
  <main class="flex-grow flex flex-col items-center p-4 sm:p-6 lg:p-8">

  <section class="w-full max-w-4xl bg-white rounded-lg shadow-lg p-6 mb-6 animate-fade-in gradient-bg">
    <h2 class="text-2xl font-bold mb-4 text-white"><i class="fas fa-plus-circle mr-2"></i>Add New Product</h2>
    <form id="addProductForm" class="flex flex-col md:flex-row gap-4">
      <input
        type="text"
        id="productName"
        placeholder="Product Name"
        class="flex-grow border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 transition"
        required
      />
      <input
        type="url"
        id="productURL"
        placeholder="Product URL"
        class="flex-grow border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 transition"
        required
      />
      <input
        type="number"
        id="productPrice"
        placeholder="Price in ₹"
        min="0"
        step="0.01"
        class="w-full md:w-40 border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 transition"
        required
      />
      <button
        type="submit"
        class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition transform hover:scale-105 shadow-lg"
        title="Add product to wishlist"
      >
        <i class="fas fa-plus mr-2"></i>Add
      </button>
    </form>
  </section>

  <section class="w-full max-w-4xl bg-white rounded-lg shadow-lg p-6 mb-6 animate-fade-in">
    <h2 class="text-2xl font-bold mb-4 text-gray-700"><i class="fas fa-heart mr-2 text-red-500"></i>Wishlist</h2>
    <div id="wishlist" class="space-y-4">
    </div>
  </section>

  <section class="w-full max-w-4xl bg-white rounded-lg shadow-lg p-6 animate-fade-in">
    <h2 class="text-2xl font-bold mb-4 text-gray-700"><i class="fas fa-lightbulb mr-2 text-yellow-500"></i>Recommended Products</h2>
    <div id="recommendations" class="space-y-4 text-gray-700">
      <p class="text-gray-500">No recommendations available.</p>
    </div>
  </section>

  <script>
    const form = document.getElementById('addProductForm');
    const wishlistEl = document.getElementById('wishlist');
    const darkModeToggle = document.getElementById('darkModeToggle');
    const body = document.body;

    let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
    let isDarkMode = localStorage.getItem('darkMode') === 'true';

    function toggleDarkMode() {
      isDarkMode = !isDarkMode;
      localStorage.setItem('darkMode', isDarkMode);
      if (isDarkMode) {
        body.classList.add('dark-mode');
        darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
      } else {
        body.classList.remove('dark-mode');
        darkModeToggle.innerHTML = '<i class="fas fa-moon"></i>';
      }
    }

    if (isDarkMode) {
      body.classList.add('dark-mode');
      darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
    }

    darkModeToggle.addEventListener('click', toggleDarkMode);


    function saveWishlist() {
      localStorage.setItem('wishlist', JSON.stringify(wishlist));
    }

    function renderWishlist() {
      wishlistEl.innerHTML = '';
      if (wishlist.length === 0) {
        wishlistEl.innerHTML = '<p class="text-gray-500">No products in wishlist.</p>';
        return;
      }

      wishlist.forEach((product, index) => {
        const productEl = document.createElement('div');
        productEl.className = 'border border-gray-300 rounded p-4 flex flex-col sm:flex-row sm:items-center sm:justify-between';


        const infoEl = document.createElement('div');
        infoEl.className = 'mb-3 sm:mb-0';

        const nameEl = document.createElement('h3');
        nameEl.className = 'text-lg font-semibold text-gray-800';
        nameEl.textContent = product.name;

        const urlEl = document.createElement('a');
        urlEl.href = product.url;
        urlEl.target = '_blank';
        urlEl.rel = 'noopener noreferrer';
        urlEl.className = 'text-blue-600 hover:underline block text-sm mb-1 truncate max-w-xs';
        urlEl.textContent = product.url;

        const priceEl = document.createElement('p');
        priceEl.className = 'text-gray-600 transition-colors duration-700 flex items-center gap-2';
        priceEl.textContent = `Current Price: ₹${product.currentPrice.toFixed(2)}`;

        const priceHistory = product.priceHistory;
        if (priceHistory.length > 1) {
          const prevPrice = priceHistory[priceHistory.length - 2].price;
          if (product.currentPrice > prevPrice) {
            const upArrow = document.createElement('i');
            upArrow.className = 'fas fa-arrow-up text-green-600';
            priceEl.appendChild(upArrow);
          } else if (product.currentPrice < prevPrice) {
            const downArrow = document.createElement('i');
            downArrow.className = 'fas fa-arrow-down text-red-600';
            priceEl.appendChild(downArrow);
          }
        }

        
        const lastUpdate = new Date(product.priceHistory[product.priceHistory.length - 1].date);
        const now = new Date();
        if ((now - lastUpdate) / 1000 < 10) {
          priceEl.classList.add('bg-yellow-200', 'text-yellow-900', 'rounded', 'px-1');
          setTimeout(() => {
            priceEl.classList.remove('bg-yellow-200', 'text-yellow-900', 'rounded', 'px-1');
          }, 3000);
        }

        infoEl.appendChild(nameEl);
        infoEl.appendChild(urlEl);
        infoEl.appendChild(priceEl);

        const toggleHistoryBtn = document.createElement('button');
        toggleHistoryBtn.className = 'text-blue-600 hover:underline text-sm mb-2 sm:mb-0';
        toggleHistoryBtn.textContent = 'Show Price History';
        toggleHistoryBtn.type = 'button';

        const historyEl = document.createElement('div');
        historyEl.className = 'mt-2 hidden text-sm text-gray-700 max-h-40 overflow-y-auto border border-gray-200 rounded p-2 bg-gray-50';

        product.priceHistory.forEach((entry) => {
          const entryEl = document.createElement('div');
          const date = new Date(entry.date);
          entryEl.textContent = `${date.toLocaleDateString()} - ₹${entry.price.toFixed(2)}`;
          historyEl.appendChild(entryEl);
        });

        toggleHistoryBtn.addEventListener('click', () => {
          if (historyEl.classList.contains('hidden')) {
            historyEl.classList.remove('hidden');
            toggleHistoryBtn.textContent = 'Hide Price History';
          } else {
            historyEl.classList.add('hidden');
            toggleHistoryBtn.textContent = 'Show Price History';
          }
        });

        const updateForm = document.createElement('form');
        updateForm.className = 'flex gap-2 items-center';

        const updateInput = document.createElement('input');
        updateInput.type = 'number';
        updateInput.min = '0';
        updateInput.step = '0.01';
        updateInput.placeholder = 'New Price ₹';
        updateInput.className = 'w-24 border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500';
        updateInput.required = true;

        const updateBtn = document.createElement('button');
        updateBtn.type = 'submit';
        updateBtn.className = 'bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700 transition';
        updateBtn.textContent = 'Update';

        updateForm.appendChild(updateInput);
        updateForm.appendChild(updateBtn);

        updateForm.addEventListener('submit', (e) => {
          e.preventDefault();
          const newPrice = parseFloat(updateInput.value);
          if (isNaN(newPrice) || newPrice < 0) {
            alert('Please enter a valid price.');
            return;
          }
          product.currentPrice = newPrice;
          product.priceHistory.push({ date: new Date().toISOString(), price: newPrice });
          saveWishlist();
          renderWishlist();
        });

        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'text-red-600 hover:text-red-800 text-lg';
        deleteBtn.title = 'Remove product from wishlist';
        deleteBtn.innerHTML = '<i class="fas fa-trash-alt text-xl"></i>';
        deleteBtn.addEventListener('click', () => {
          if (confirm(`Remove "${product.name}" from wishlist?`)) {
            wishlist.splice(index, 1);
            saveWishlist();
            renderWishlist();
          }
        });

        const rightSideEl = document.createElement('div');
        rightSideEl.className = 'flex flex-col sm:flex-row sm:items-center gap-3';

        rightSideEl.appendChild(updateForm);
        rightSideEl.appendChild(deleteBtn);

        productEl.appendChild(infoEl);
        productEl.appendChild(toggleHistoryBtn);
        productEl.appendChild(rightSideEl);
        productEl.appendChild(historyEl);

        wishlistEl.appendChild(productEl);
      });
    }

      form.addEventListener('submit', (e) => {
        e.preventDefault();
        const name = document.getElementById('productName').value.trim();
        const url = document.getElementById('productURL').value.trim();
        const price = parseFloat(document.getElementById('productPrice').value);
        if (!name || !url || isNaN(price) || price < 0) {
          alert('Please enter valid product name, URL, and price.');
          return;
        }
        const newProduct = {
          name,
          url,
          currentPrice: price,
          priceHistory: [{ date: new Date().toISOString(), price }],
        };
        wishlist.push(newProduct);
        saveWishlist();
        renderWishlist();
        form.reset();
      });

      function simulatePriceUpdate() {
        let updated = false;
        wishlist.forEach((product) => {
          if (Math.random() < 0.5) {
            const changePercent = (Math.random() * 10 - 5) / 100;
            const newPrice = Math.max(0, product.currentPrice * (1 + changePercent));
            if (newPrice.toFixed(2) !== product.currentPrice.toFixed(2)) {
              product.currentPrice = parseFloat(newPrice.toFixed(2));
              product.priceHistory.push({ date: new Date().toISOString(), price: product.currentPrice });
              updated = true;
            }
          }
        });
        if (updated) {
          saveWishlist();
          renderWishlist();
        }
      }

      setInterval(simulatePriceUpdate, 60000);

    renderWishlist();
    function generateRecommendations() {
      const recommendationsEl = document.getElementById('recommendations');
      recommendationsEl.innerHTML = '';

      if (wishlist.length === 0) {
        recommendationsEl.innerHTML = '<p class="text-gray-500">No recommendations available.</p>';
        return;
      }

      const recs = [];
      wishlist.forEach((product) => {
        for (let i = 1; i <= 2; i++) {
          const priceFluctuation = (Math.random() * 0.4 - 0.2); // -20% to +20%
          const recPrice = Math.max(1, product.currentPrice * (1 + priceFluctuation));
          recs.push({
            name: `${product.name} Variant ${i}`,
            price: parseFloat(recPrice.toFixed(2)),
            url: product.url,
          });
        }
      });

      recs.forEach((rec) => {
        const recEl = document.createElement('div');
        recEl.className = 'border border-gray-300 rounded p-3 flex flex-col sm:flex-row sm:items-center sm:justify-between';

        const infoEl = document.createElement('div');
        infoEl.className = 'mb-2 sm:mb-0';

        const nameEl = document.createElement('h3');
        nameEl.className = 'text-lg font-semibold text-gray-800';
        nameEl.textContent = rec.name;

        const urlEl = document.createElement('a');
        urlEl.href = rec.url;
        urlEl.target = '_blank';
        urlEl.rel = 'noopener noreferrer';
        urlEl.className = 'text-blue-600 hover:underline block text-sm mb-1 truncate max-w-xs';
        urlEl.textContent = rec.url;

        const priceEl = document.createElement('p');
        priceEl.className = 'text-gray-600';
        priceEl.textContent = `Price: ₹${rec.price.toFixed(2)}`;

        infoEl.appendChild(nameEl);
        infoEl.appendChild(urlEl);
        infoEl.appendChild(priceEl);

        recEl.appendChild(infoEl);
        recommendationsEl.appendChild(recEl);
      });
    }

    function updateApp() {
      saveWishlist();
      renderWishlist();
      generateRecommendations();
    }

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const name = document.getElementById('productName').value.trim();
      const url = document.getElementById('productURL').value.trim();
      const price = parseFloat(document.getElementById('productPrice').value);
      if (!name || !url || isNaN(price) || price < 0) {
        alert('Please enter valid product name, URL, and price.');
        return;
      }
      const newProduct = {
        name,
        url,
        currentPrice: price,
        priceHistory: [{ date: new Date().toISOString(), price }],
      };
      wishlist.push(newProduct);
      updateApp();
      form.reset();
    });

    function simulatePriceUpdate() {
      let updated = false;
      wishlist.forEach((product) => {
        if (Math.random() < 0.5) {
          const changePercent = (Math.random() * 10 - 5) / 100;
          const newPrice = Math.max(0, product.currentPrice * (1 + changePercent));
          if (newPrice.toFixed(2) !== product.currentPrice.toFixed(2)) {
            product.currentPrice = parseFloat(newPrice.toFixed(2));
            product.priceHistory.push({ date: new Date().toISOString(), price: product.currentPrice });
            updated = true;
          }
        }
      });
      if (updated) {
        updateApp();
      }
    }
    updateApp();
  </script>
</body>
</html>
